---
import Layout from "../layouts/Layout.astro";
import CategorySelector from "../components/ui/category-selector";
import graphicCategory from "@assets/design-category.jpg";
import fashionCategory from "@assets/fashion-category.jpg";
import { getImage } from "astro:assets";
import type { IOptimizedImages } from "src/types/types";
import { getCldImageUrl } from "astro-cloudinary/helpers";
const graphicCategoryUrl = getCldImageUrl({
  src: "design-category_mykw75",
  format: "auto",
});
const fashionCategoryUrl = getCldImageUrl({
  src: "fashion-category_p2k6on",
  format: "auto",
});
const unoptimizedImages = [
  {
    image: graphicCategory,
    name: "graphic",
    subtitle: "graphic portfolio",
    path: "graphic",
    alt: "graphic portfolio",
    url: graphicCategoryUrl,
  },
  {
    image: fashionCategory,
    name: "fashion",
    subtitle: "fashion portfolio",
    path: "fashion",
    alt: "fashion portfolio",
    url: fashionCategoryUrl,
  },
];

const optimizedImages = await Promise.all(
  unoptimizedImages.map(async (image: IOptimizedImages) => {
    const oI = await getImage({
      src: image.image,
      format: "webp",
      quality: 50,
    });
    return { ...image, optimizedImage: oI };
  }),
);
---

<Layout>
  <CategorySelector client:load images={optimizedImages} />
</Layout>
